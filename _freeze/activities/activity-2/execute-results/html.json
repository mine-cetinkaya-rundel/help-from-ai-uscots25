{
  "hash": "5007162972fbc9e41ae87e16fe304074",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Activity #2\"\n---\n\nUse **[ellmer](https://ellmer.tidyverse.org)** to interact with the an LLM (Anthropic, in this case) to generate feedback.\n\n## Tooling\n\n\n\n`prompt.R`:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nfunction (question, rubric, answer) \n{\n    chat <- chat_anthropic(system_prompt = paste(\"You are a helpful course instructor teaching a course on data science with the R programming language and the tidyverse and tidymodels suite of packages. You like to give succinct but precise feedback.\", \n        glue_collapse(read_lines(\"system-prompt/pipes.qmd\"))))\n    chat$chat(glue(\"Carefully read the {question} and the {rubric_detailed}, then evaluate {answer} against the {rubric_detailed} to provide feedback. \\n      Provide feedback in an output section named **Feedback:**. \\n      Format the feedback as bullet points: Each bullet point should first state the rubric item text from {rubric}, and then provide one sentence explaining whether the {answer} meets the {rubric} item.\\n      Do not give away the correct answer in the feedback.\"))\n}\n```\n\n\n:::\n:::\n\n\n**Note:** The system prompt points to a file that has the contents of the [pipes chapter](https://style.tidyverse.org/pipes.html) of the Tidyverse style guide.\n\n## Example: Tidying\n\nBelow is a question on tidying.\n\n::: question\nFor this question you will work with inflation data from various countries in the world over the last 30 years.\nThe dataset is called `country-inflation.csv` and it's in your `data` folder.\n\nReshape (pivot) `country_inflation` such that each row represents a country/year combination, with columns `country`, `year`, and `annual_inflation`.\nThen, display the resulting data frame and state how many rows and columns it has.\n\n:::\n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Code for constructing function inputs\"}\nquestion <- read_lines(\"questions/tidy-country-inflation-pivot-longer/tidy-country-inflation-pivot-longer-Q.qmd\") |>\n  glue_collapse() |>\n  str_remove(\"---.*?---\")\n\nrubric <- read_lines(\"questions/tidy-country-inflation-pivot-longer/tidy-country-inflation-pivot-longer-R.qmd\") |>\n  glue_collapse() |>\n  str_remove(\"---.*?---\")\n\nrubric_detailed <- read_lines(\"questions/tidy-country-inflation-pivot-longer/tidy-country-inflation-pivot-longer-RD.qmd\") |>\n  glue_collapse() |>\n  str_remove(\"---.*?---\")\n\nbad_answer <- read_lines(\"questions/tidy-country-inflation-pivot-longer/tidy-country-inflation-pivot-longer-sample-answer-bad.qmd\") |>\n  glue_collapse() |>\n  str_remove(\"---.*?---\")\n\ngood_answer <- read_lines(\"questions/tidy-country-inflation-pivot-longer/tidy-country-inflation-pivot-longer-sample-answer-good.qmd\") |>\n  glue_collapse() |>\n  str_remove(\"---.*?---\")\n```\n:::\n\n\n::: {.panel-tabset}\n\n### Bad\n\nBelow is what we might consider a bad answer to this question.\n\n::: answer\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncountry_inflation <- read_csv(\"data/country-inflation.csv\")\n```\n:::\n\n\nThere are 3 columns and 1178 rows in this new data frame. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- country_inflation |> \n    pivot_longer(\n    cols = -country,names_to = \"year\", \n    values_to = \"inflationrate\"\n               )\nprint(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1,178 × 3\n   country   year  inflationrate\n   <chr>     <chr>         <dbl>\n 1 Australia 1993          1.75 \n 2 Australia 1994          1.97 \n 3 Australia 1995          4.63 \n 4 Australia 1996          2.62 \n 5 Australia 1997          0.225\n 6 Australia 1998          0.860\n 7 Australia 1999          1.48 \n 8 Australia 2000          4.46 \n 9 Australia 2001          4.41 \n10 Australia 2002          2.98 \n# ℹ 1,168 more rows\n```\n\n\n:::\n:::\n\n\n:::\n\nProvide feedback to the answer above using the following rubric.\n\n::: rubric\n-   Code uses `pivot_longer()`.\n\n-   Code names the data frame something short and informative.\n\n-   Code names the year variable `year` and the inflation variable `annual_inflation`.\n\n-   Code transforms the year variable to numeric inside `pivot_longer()`.\n\n-   Output displays `country_inflation_longer`.\n\n-   Output has 3 columns: `country`, `year`, and `annual_inflation`.\n\n-   Narrative states the correct numbers of rows and columns.\n\n-   Code style and readability: Line breaks after each |>, proper indentation, spaces around = signs if they are present, and spaces after commas if they are present.\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprompt(\n  question = question, \n  rubric = rubric,\n  answer = bad_answer\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nUsing model = \"claude-sonnet-4-20250514\".\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n**Feedback:**\n\n- **Code uses `pivot_longer()`**: ✓ The code correctly uses `pivot_longer()` to\nreshape the data from wide to long format.\n\n- **Code names the data frame something short and informative**: ✗ The data \nframe is named `df` which is too generic and not informative about what the \ndata contains.\n\n- **Code names the year variable `year` and the inflation variable \n`annual_inflation`**: ✗ While the year variable is correctly named `year`, the \ninflation variable is named `inflationrate` instead of the required \n`annual_inflation`.\n\n- **Code transforms the year variable to numeric inside `pivot_longer()`**: ✗ \nThe code is missing the `names_transform = as.numeric` argument that was \nspecifically required to convert the year variable to numeric type.\n\n- **Output displays `country_inflation_longer`**: ✗ The output shows `df` \ninstead of the expected `country_inflation_longer` data frame name.\n\n- **Output has 3 columns: `country`, `year`, and `annual_inflation`**: ✗ While \nthere are 3 columns, the inflation column is named `inflationrate` rather than \n`annual_inflation`.\n\n- **Narrative states the correct numbers of rows and columns**: ✗ The narrative\nstates \"1178 rows and 3\" but should state \"1,178 rows and 3 columns\" for \ncomplete accuracy.\n\n- **Code style and readability**: ✗ The code has inconsistent spacing (missing \nspaces around `=` in `names_to = \"year\"` and `values_to = \"inflationrate\"`), \nand the closing parenthesis alignment could be improved.\n```\n\n\n:::\n:::\n\n\n### Bad, again\n\nProvide feedback to the same answer from the previous tab.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprompt(\n  question = question, \n  rubric = rubric,\n  answer = bad_answer\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nUsing model = \"claude-sonnet-4-20250514\".\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n**Feedback:**\n\n• **Code uses `pivot_longer()`** - ✓ The code correctly uses `pivot_longer()` \nto reshape the data from wide to long format.\n\n• **Code names the data frame something short and informative** - ✗ The data \nframe is named `df` which is not informative about what the data contains.\n\n• **Code names the year variable `year` and the inflation variable \n`annual_inflation`** - ✗ While the year variable is correctly named `year`, the\ninflation variable is named `inflationrate` instead of the required \n`annual_inflation`.\n\n• **Code transforms the year variable to numeric inside `pivot_longer()`** - ✗ \nThe code is missing the `names_transform = as.numeric` argument that was \nspecifically required to convert the year variable to numeric during pivoting.\n\n• **Output displays `country_inflation_longer`** - ✗ The output shows a data \nframe named `df` rather than the expected `country_inflation_longer`.\n\n• **Output has 3 columns: `country`, `year`, and `annual_inflation`** - ✗ While\nthere are 3 columns, the third column is named `inflationrate` rather than \n`annual_inflation`.\n\n• **Narrative states the correct numbers of rows and columns** - ✗ The \nnarrative states 1178 rows and 3 columns but places this information before the\ncode chunk rather than after displaying the results.\n\n• **Code style and readability** - ✗ The code has inconsistent spacing (missing\nspaces after commas in some places) and could benefit from better formatting \nalignment within the `pivot_longer()` function.\n```\n\n\n:::\n:::\n\n\n### Good\n\nBelow is what we might consider a good answer to this question.\n\n::: answer\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncountry_inflation <- read_csv(\"data/country-inflation.csv\")\n```\n:::\n\n\nThe data frame, \"yearly_inflation,\" has 1,178 rows and three columns.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyearly_inflation <- country_inflation |>\n  pivot_longer(\n    cols = `1993`:`2023`,\n    names_to = \"year\",\n    names_transform = as.numeric,\n    values_to = \"annual_inflation\"\n  )\n\nyearly_inflation\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1,178 × 3\n   country    year annual_inflation\n   <chr>     <dbl>            <dbl>\n 1 Australia  1993            1.75 \n 2 Australia  1994            1.97 \n 3 Australia  1995            4.63 \n 4 Australia  1996            2.62 \n 5 Australia  1997            0.225\n 6 Australia  1998            0.860\n 7 Australia  1999            1.48 \n 8 Australia  2000            4.46 \n 9 Australia  2001            4.41 \n10 Australia  2002            2.98 \n# ℹ 1,168 more rows\n```\n\n\n:::\n:::\n\n\n:::\n\nProvide feedback to the answer above.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprompt(\n  question = question, \n  rubric = rubric,\n  answer = good_answer\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nUsing model = \"claude-sonnet-4-20250514\".\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n**Feedback:**\n\n• **Code uses `pivot_longer()`:** ✓ The code correctly uses `pivot_longer()` to\nreshape the data from wide to long format.\n\n• **Code names the data frame something short and informative:** ✓ The data \nframe is named `yearly_inflation`, which is both concise and descriptive of its\ncontents.\n\n• **Code names the year variable `year` and the inflation variable \n`annual_inflation`:** ✓ The code properly uses `names_to = \"year\"` and \n`values_to = \"annual_inflation\"` to create the required column names.\n\n• **Code transforms the year variable to numeric inside `pivot_longer()`:** ✓ \nThe code includes `names_transform = as.numeric` to convert the year variable \nto numeric type during the pivot operation.\n\n• **Output displays `country_inflation_longer`:** ✗ The rubric expects the \noutput to display a data frame named `country_inflation_longer`, but the code \ncreates and displays `yearly_inflation` instead.\n\n• **Output has 3 columns: `country`, `year`, and `annual_inflation`:** ✓ The \nresulting data frame contains the three required columns with the correct \nnames.\n\n• **Narrative states the correct numbers of rows and columns:** ✓ The narrative\ncorrectly states that the data frame has 1,178 rows and 3 columns.\n\n• **Code style and readability:** ✓ The code follows proper tidyverse style \nwith line breaks after the pipe operator, appropriate indentation, and proper \nspacing around operators and after commas.\n```\n\n\n:::\n:::\n\n\n:::\n\n## Example: Modeling\n\nBelow is a question on modeling:\n\nFor this part of the analysis, the data set that will be used is called `births14` , and it is included in the openintro package you loaded at the beginning of the assignment.\nNote: this question relies on an earlier part of the assignment, where the `births14` dataset is filtered to remove NA values and assigned the name `births14_habitgiven`. \n\na.  Fit a linear model that predicts weight from habit and save the model object. Then, provide the tidy summary output.\n\nb.  Write the estimated least squares regression line below using proper notation.\n\nc.  Interpret the intercept in the context of the data and the research question. Is the intercept meaningful in this context? Why or why not?\n\nd.  Interpret the slope in the context of the data and the research question.\n\n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Code for constructing function inputs\"}\nquestion <- read_lines(\"questions/model-birth-simple-linear/model-births-simple-linear-Q.qmd\") |>\n  glue_collapse() |>\n  str_remove(\"---.*?---\")\n\nrubric <- read_lines(\"questions/model-birth-simple-linear/model-births-simple-linear-R.qmd\") |>\n  glue_collapse() |>\n  str_remove(\"---.*?---\")\n\nrubric_detailed <- read_lines(\"questions/model-birth-simple-linear/model-births-simple-linear-RD.qmd\") |>\n  glue_collapse() |>\n  str_remove(\"---.*?---\")\n\nbad_answer <- read_lines(\"questions/model-birth-simple-linear/model-births-simple-linear-sample-answer-bad.qmd\") |>\n  glue_collapse() |>\n  str_remove(\"---.*?---\")\n\ngood_answer <- read_lines(\"questions/model-birth-simple-linear/model-births-simple-linear-sample-answer-bad.qmd\") |>\n  glue_collapse() |>\n  str_remove(\"---.*?---\")\n```\n:::\n\n\n::: {.panel-tabset}\n\n### Bad\n\nBelow is what we might consider a bad answer to this question.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(openintro)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbirths14_habitgiven <- births14 |>\n  filter(!is.na(habit))\n```\n:::\n\n\na.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\nwt_habit_fit <- linear_reg() %>% fit(weight~habit,data=births14_habitgiven)\n\nwt_habit_fit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nparsnip model object\n\n\nCall:\nstats::lm(formula = weight ~ habit, data = data)\n\nCoefficients:\n(Intercept)  habitsmoker  \n     7.2699      -0.5927  \n```\n\n\n:::\n:::\n\n\nb.  \n\n$$ y = 7.2 + 0.6\\times smoker_factor $$\n\nc.  When the habit factor value = 0, and because the LSRL line is negative, and the median birth weight for smoking mothers is less than non-smoking mothers. The weight of mothers born to non-smoker mothers is always 7.27 pounds. \n\nd.  A baby born to a smoker is 0.59 pounds lighter than a baby with a non-smoker mother. \n\n\nProvide feedback to the answer above using the following rubric.\n\n-   Part (a) - Code correctly fits linear regression model with the correct response and predictor variables using tidymodels functions.\n\n-   Part (a) - Regression summary is displayed with `tidy()`.\n\n-   Part (b) - Estimated least squares regression line is correct.\n\n-   Part (c) - Narrative provides correct interpretation of the intercept in context of the data.\n\n-   Part (c) - Narrative states that the intercept is meaningful and provides correct justification.\n\n-   Part (d) - Narrative provides correct interpretation of the slope in context of the data.\n\n-   Code smell, style, and readability: The code should follow the Tidyverse style guide.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprompt(\n  question = question, \n  rubric = rubric,\n  answer = bad_answer\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nUsing model = \"claude-sonnet-4-20250514\".\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n**Feedback:**\n\n- **Part (a) - Code correctly fits linear regression model with the correct \nresponse and predictor variables using tidymodels functions.** Your code \ncorrectly fits a linear regression model with weight as the response and habit \nas the predictor using the `linear_reg()` and `fit()` functions from \ntidymodels.\n\n- **Part (a) - Regression summary is displayed with `tidy()`.** You need to \ndisplay the regression summary using the `tidy()` function - currently you're \nonly showing the model object itself.\n\n- **Part (b) - Estimated least squares regression line is correct.** Your \nequation has several issues: the coefficient values don't match what would come\nfrom the actual model output, you're missing the \"hat\" notation for predicted \nvalues, and the variable name should match the actual coding of the habit \nvariable.\n\n- **Part (c) - Narrative provides correct interpretation of the intercept in \ncontext of the data.** Your interpretation is confusing and contains errors - \nyou mention \"habit factor value = 0\" and \"weight of mothers\" instead of \nfocusing on baby weights, and you state the weight is \"always\" 7.27 pounds \nrather than using language about expectations or averages.\n\n- **Part (c) - Narrative states that the intercept is meaningful and provides \ncorrect justification.** You haven't addressed whether the intercept is \nmeaningful in this context or provided appropriate justification for your \nconclusion.\n\n- **Part (d) - Narrative provides correct interpretation of the slope in \ncontext of the data.** Your interpretation is close but needs to include \nlanguage about expectations or averages rather than making a definitive \nstatement about individual babies.\n\n- **Code smell, style, and readability: The code should follow the Tidyverse \nstyle guide.** Your code needs improvement in spacing - there should be spaces \naround the `=` sign and after commas in function calls (e.g., `data = \nbirths14_habitgiven`).\n```\n\n\n:::\n:::\n\n\n### Good\n\nBelow is what we might consider a good answer to this question.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(openintro)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbirths14_habitgiven <- births14 |>\n  filter(!is.na(habit))\n```\n:::\n\n\na.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\nwt_habit_fit <- linear_reg() |>\n  fit(weight ~ habit, data = births14_habitgiven)\n\ntidy(wt_habit_fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic    p.value\n  <chr>          <dbl>     <dbl>     <dbl>      <dbl>\n1 (Intercept)    7.27     0.0435    167.   0         \n2 habitsmoker   -0.593    0.128      -4.65 0.00000382\n```\n\n\n:::\n:::\n\n\nb.  \n\n$$ \\widehat{weight} = 7.27 - 0.59 \\times smoker $$\n\nc.  The expected weight of babies born to non-smoker mothers is 7.27 pounds. This intercept is meaningful because it is plausible that women in the sample are non-smokers, and 7.27 lbs is a possible weight of a newborn baby. \n\nd.  Babies born to smokers are, on average, about 0.59 pounds lighter than babies with non-smoker mothers. \n\n\nProvide feedback to the answer above.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprompt(\n  question = question, \n  rubric = rubric,\n  answer = good_answer\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nUsing model = \"claude-sonnet-4-20250514\".\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n**Feedback:**\n\n• **Part (a) - Code correctly fits linear regression model with the correct \nresponse and predictor variables using tidymodels functions.** Your code \ncorrectly uses `linear_reg()` and `fit()` with the appropriate variables, but \nyou need to add proper spacing around the `=` sign in \n`data=births14_habitgiven`.\n\n• **Part (a) - Regression summary is displayed with `tidy()`.** This \nrequirement is not met - you displayed the raw model output instead of using \nthe `tidy()` function to create a clean summary table.\n\n• **Part (b) - Estimated least squares regression line is correct.** This does \nnot meet the requirement - your equation has incorrect coefficient values and \nshould use proper notation with a hat symbol over y to indicate predicted \nvalues.\n\n• **Part (c) - Narrative provides correct interpretation of the intercept in \ncontext of the data.** This does not meet the requirement - your interpretation\nis confusing and doesn't clearly explain what the intercept represents in terms\nof expected baby weight for non-smoking mothers.\n\n• **Part (c) - Narrative states that the intercept is meaningful and provides \ncorrect justification.** This requirement is not met - you don't clearly state \nwhether the intercept is meaningful or provide proper justification for your \nconclusion.\n\n• **Part (d) - Narrative provides correct interpretation of the slope in \ncontext of the data.** This partially meets the requirement but should include \nlanguage about \"on average\" or \"expected\" rather than stating it as an absolute\nfact about individual babies.\n\n• **Code smell, style, and readability: The code should follow the Tidyverse \nstyle guide.** This partially meets the requirement - while you use the base \npipe correctly, you need to add spaces around the equals sign and after the \ncomma in your `fit()` function.\n```\n\n\n:::\n:::\n\n\n### Good, again\n\nProvide feedback to the same answer from the previous tab.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprompt(\n  question = question, \n  rubric = rubric,\n  answer = good_answer\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nUsing model = \"claude-sonnet-4-20250514\".\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n**Feedback:**\n\n• **Part (a) - Code correctly fits linear regression model with the correct \nresponse and predictor variables using tidymodels functions.** Your code \ncorrectly uses `linear_reg()` and `fit()` with the appropriate variables, but \nyou need to add a space after the comma in your function call.\n\n• **Part (a) - Regression summary is displayed with `tidy()`.** This \nrequirement is not met - you need to display the tidy summary output using the \n`tidy()` function on your fitted model object.\n\n• **Part (b) - Estimated least squares regression line is correct.** This does \nnot meet the requirement - you need to use the actual coefficient values from \nyour model output and include proper notation (such as $\\widehat{y}$ for the \npredicted value).\n\n• **Part (c) - Narrative provides correct interpretation of the intercept in \ncontext of the data.** This does not meet the requirement - your interpretation\nis unclear and contains errors; you need to explain what the intercept \nrepresents in terms of expected baby weight for a specific group, using \nlanguage like \"on average\" or \"expected.\"\n\n• **Part (c) - Narrative states that the intercept is meaningful and provides \ncorrect justification.** This requirement is not met - you need to clearly \nstate whether the intercept is meaningful and provide a proper justification \nbased on the plausibility of the baseline condition.\n\n• **Part (d) - Narrative provides correct interpretation of the slope in \ncontext of the data.** This partially meets the requirement but needs \nimprovement - you should use language indicating this is about \nexpectations/averages rather than individual cases, and ensure your numerical \nvalues match the model output.\n\n• **Code smell, style, and readability: The code should follow the Tidyverse \nstyle guide.** Your code mostly follows the style guide but needs a space after\nthe comma in your `fit()` function call.\n```\n\n\n:::\n:::\n\n\n:::\n",
    "supporting": [
      "activity-2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}